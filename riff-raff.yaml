regions:
  - eu-west-1
stacks:
  - flexible # TODO: check

templates:
  formstack-cloud-formation-template:
    type: cloud-formation
    parameters:
      appendStageToCloudFormationStackName: false
      cloudFormationStackByTags: false
      prependStackToCloudFormationStackName: false

deployments:

  cloudformation-account-1:
    template: formstack-cloud-formation-template
    parameters:
      cloudFormationStackName: delete-expired-formstack-data-account-1
      templateParameters:
        FormstackAccountRef: account-1

  cloudformation-account-2:
    template: formstack-cloud-formation-template
    parameters:
      cloudFormationStackName: delete-expired-formstack-data-account-2
      templateParameters:
        FormstackAccountRef: account-2

  delete-expired-formstack-data-lambdas:
    type: aws-lambda
    parameters:
      bucket: delete-expired-formstack-data-dist
      fileName: app.jar
      functionNames:
        - formstack-form-deletion-lambda-account-1-
        - formstack-form-deletion-lambda-account-2-
        - formstack-submission-deletion-lambda-account-1-
        - formstack-submission-deletion-lambda-account-2-
      prefixStack: false
      prefixStackToKey: false
    dependencies:
      - cloudformation-account-1
      - cloudformation-account-2
